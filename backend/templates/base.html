
{% load static %}
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Mediscan{% endblock %}</title>

  <!-- ✅ Tailwind output (локально через static) -->
  <link rel="stylesheet" href="{% static 'css/app.css' %}">

  <style>
    /* Invitro-like anchor offset */
    html { scroll-behavior: smooth; scroll-padding-top: 92px; }
  </style>
</head>

<body class="min-h-screen bg-sky-300 text-slate-900">

<!-- Topbar -->
<header class="bg-blue-600 text-white border-b border-blue-700">
  <div class="max-w-6xl mx-auto px-4">
    <!-- Top row -->
    <div class="h-16 flex items-center justify-between gap-4">
      <!-- Logo -->
      <a href="{% url 'home' %}" class="flex items-center gap-3">
        <div class="h-10 w-10 rounded-2xl bg-white/15 border border-white/20"></div>
        <div class="leading-tight">
          <div class="font-semibold text-lg text-white">Mediscan</div>
          <div class="text-xs text-blue-100">диагностика и анализы</div>
        </div>
      </a>

      <!-- City + phone -->
      <div class="hidden lg:flex items-center gap-6">
        <div class="flex items-center gap-2">
          <span class="text-sm text-blue-100">Город</span>

          <button type="button"
            class="inline-flex items-center gap-2 px-3 py-2 rounded-full
                   bg-white/10 hover:bg-white/20 text-sm text-white transition">
            <span class="font-medium text-white">{{ current_city|default:"Выберите" }}</span>
            <span class="text-blue-100">▾</span>
          </button>
        </div>

        <a href="tel:+74951234567"
           class="text-sm font-semibold text-white hover:underline">
          +7 (495) 123-45-67
        </a>
      </div>

      <!-- Actions -->
      <div class="flex items-center gap-2">
        <button id="openSearch"
          class="hidden md:inline-flex items-center justify-center rounded-full
                 bg-white/10 hover:bg-white/20
                 px-4 py-2 text-sm text-white transition">
          Поиск
        </button>

        <!-- Main CTA -->
        <a href="/appointments/create/"
           class="inline-flex items-center justify-center rounded-full
                  bg-yellow-400 text-blue-900
                  px-4 py-2 text-sm font-semibold
                  hover:bg-yellow-300 transition">
          Записаться
        </a>

        <a href="#"
           class="hidden sm:inline-flex rounded-full
                  bg-white/10 hover:bg-white/20
                  px-4 py-2 text-sm text-white transition">
          Результаты
        </a>

        <a href="#"
           class="hidden sm:inline-flex rounded-full
                  bg-white/10 hover:bg-white/20
                  px-4 py-2 text-sm text-white transition">
          ЛК
        </a>

        <a href="#"
           class="hidden sm:inline-flex rounded-full
                  bg-white/10 hover:bg-white/20
                  px-4 py-2 text-sm text-white transition">
          Корзина
        </a>
      </div>
    </div>

    <!-- Second row: main menu -->
    <div class="pb-4 flex flex-wrap gap-2">
      <a href="/services/"
         class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20
                text-sm text-white transition">
        Услуги
      </a>

      <a href="/#promos"
         class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20
                text-sm text-white transition">
        Акции
      </a>

      <a href="/#doctors"
         class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20
                text-sm text-white transition">
        Врачи
      </a>

      <a href="/#contacts"
         class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20
                text-sm text-white transition">
        Контакты
      </a>

      <a href="/#feedback"
         class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20
                text-sm text-white transition">
        Обратная связь
      </a>

      <a href="/#telegram"
         class="px-4 py-2 rounded-full bg-white/10 hover:bg-white/20
                text-sm text-white transition">
        Telegram-бот
      </a>
    </div>
  </div>
</header>

<!-- Search modal -->
<div id="searchModal" class="hidden fixed inset-0 bg-black/30 z-50">
  <div class="max-w-2xl mx-auto mt-24 bg-white rounded-2xl p-4 shadow-lg">
    <div class="flex items-center justify-between">
      <div class="font-semibold">Поиск по сайту</div>
      <button id="closeSearch" class="px-3 py-1 rounded-xl hover:bg-slate-100">✕</button>
    </div>
    <form class="mt-3" action="/services/" method="get">
      <input name="q" placeholder="Например: МРТ, УЗИ, анализ крови"
             class="w-full rounded-xl border-slate-200 focus:border-slate-400 focus:ring-0">
      <div class="mt-3 flex gap-2">
        <button class="rounded-xl bg-slate-900 text-white px-4 py-2 text-sm hover:bg-slate-800">
          Искать
        </button>
        <button type="button" id="closeSearch2"
                class="rounded-xl border border-slate-200 px-4 py-2 text-sm hover:bg-slate-50">
          Закрыть
        </button>
      </div>
    </form>
  </div>
</div>

<main class="max-w-6xl mx-auto px-4 py-8">
  {% block content %}{% endblock %}
</main>

<!-- Footer (yellow) -->
<footer class="bg-yellow-200 border-t border-yellow-200">
  <div class="max-w-6xl mx-auto px-4 py-10">
    <div class="grid grid-cols-1 md:grid-cols-12 gap-8">
      <div class="md:col-span-4">
        <div class="font-semibold text-lg text-yellow-900">Mediscan</div>
        <div class="mt-2 text-sm text-yellow-800">
          Медицинская диагностика и лабораторные исследования.
        </div>
        <div class="mt-4 text-sm">
          <a class="font-semibold text-yellow-900 hover:text-yellow-700 hover:underline transition"
             href="tel:+74951234567">+7 (495) 123-45-67</a><br>
          <span class="text-yellow-800">info@mediscan.example</span>
        </div>
      </div>

      <div class="md:col-span-3">
        <div class="text-sm font-semibold text-yellow-900">Карта сайта</div>
        <div class="mt-3 space-y-2 text-sm text-yellow-800">
          <a class="block hover:text-yellow-700 hover:underline transition" href="/services/">Услуги</a>
          <a class="block hover:text-yellow-700 hover:underline transition" href="/#promos">Акции</a>
          <a class="block hover:text-yellow-700 hover:underline transition" href="/#doctors">Врачи</a>
          <a class="block hover:text-yellow-700 hover:underline transition" href="/#contacts">Контакты</a>
        </div>
      </div>

      <div class="md:col-span-2">
        <div class="text-sm font-semibold text-yellow-900">Мессенджеры</div>
        <div class="mt-3 space-y-2 text-sm text-yellow-800">
          <a class="block hover:text-yellow-700 hover:underline transition" href="/#telegram">Telegram</a>
          <a class="block hover:text-yellow-700 hover:underline transition" href="#">WhatsApp</a>
          <a class="block hover:text-yellow-700 hover:underline transition" href="#">VK</a>
        </div>
      </div>

      <div class="md:col-span-3">
        <div class="text-sm font-semibold text-yellow-900">Юридическая информация</div>
        <div class="mt-3 text-xs text-yellow-800 leading-relaxed">
          Информация на сайте носит справочный характер и не является публичной офертой.
          Возможны противопоказания — необходима консультация специалиста.
          <div class="mt-3">
            <a class="hover:text-yellow-700 hover:underline transition" href="#">Политика конфиденциальности</a><br>
            <a class="hover:text-yellow-700 hover:underline transition" href="#">Политика персональных данных</a>
          </div>
        </div>
      </div>
    </div>

    <div class="mt-8 text-xs text-yellow-700">
      © {{ now|date:"Y" }} Mediscan. Все права защищены.
    </div>
  </div>
</footer>

<!-- Search modal JS -->
<script>
(function () {
  const modal = document.getElementById("searchModal");
  const openBtn = document.getElementById("openSearch");
  const closeBtn = document.getElementById("closeSearch");
  const closeBtn2 = document.getElementById("closeSearch2");

  if (!modal || !openBtn || !closeBtn || !closeBtn2) return;

  function open() { modal.classList.remove("hidden"); }
  function close() { modal.classList.add("hidden"); }

  openBtn.addEventListener("click", open);
  closeBtn.addEventListener("click", close);
  closeBtn2.addEventListener("click", close);
  modal.addEventListener("click", (e) => { if (e.target === modal) close(); });
})();
</script>

<!-- Invitro-like smooth anchor scroll with header offset -->
<script>
(function () {
  const HEADER_SELECTOR = "header";
  const EXTRA_OFFSET = 12;

  function headerOffset() {
    const header = document.querySelector(HEADER_SELECTOR);
    if (!header) return EXTRA_OFFSET;

    const style = getComputedStyle(header);
    const isFixed = style.position === "fixed" || style.position === "sticky";
    const h = isFixed ? header.getBoundingClientRect().height : 0;
    return Math.round(h + EXTRA_OFFSET);
  }

  function scrollToHash(hash) {
    const el = document.querySelector(hash);
    if (!el) return;
    const y = el.getBoundingClientRect().top + window.pageYOffset - headerOffset();
    window.scrollTo({ top: y, behavior: "smooth" });
  }

  document.addEventListener("click", (e) => {
    const a = e.target.closest('a[href^="#"]');
    if (!a) return;

    const hash = a.getAttribute("href");
    if (!hash || hash === "#") return;

    const target = document.querySelector(hash);
    if (!target) return;

    e.preventDefault();
    history.replaceState(null, "", hash);
    scrollToHash(hash);
  });

  window.addEventListener("load", () => {
    const hash = window.location.hash;
    if (hash && document.querySelector(hash)) {
      setTimeout(() => scrollToHash(hash), 60);
    }
  });
})();
</script>

</body>
</html>